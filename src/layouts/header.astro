---
import Moon from '@lucide/astro/icons/moon';
import Sun from '@lucide/astro/icons/sun';
import Menu from '@lucide/astro/icons/menu';
import X from '@lucide/astro/icons/x';

const navLinks = [
  {
    href: '/about',
    label: 'About',
  },
  {
    href: '/blog',
    label: 'Blog',
  },
  {
    href: '/videos',
    label: 'Videos',
  },
];
---

<header
  class="flex justify-between z-50 max-w-site items-center mx-auto px-4 py-2"
>
  <a
    href="/"
    class="group flex items-center gap-3 text-xl tracking-tight font-mono"
  >
    <img
      src="/assets/pixel_avatar.png"
      alt="Ely Lucas Logo"
      class="inline h-16 w-16"
    />
    <!-- <img
      src="/assets/pixel_avatar.png"
      alt="Ely Lucas Logo"
      class="h-10 w-10 rounded-full ring-2 ring-primary/30 group-hover:ring-primary/60 transition-all"
    /> -->
    <span class="flex items-center gap-1">
      <span
        class="text-muted-foreground group-hover:text-foreground/50 transition-colors"
        >&lt;</span
      >
      <span
        class="text-primary font-bold group-hover:text-primary/80 transition-colors"
        >Ely</span
      >
      <span
        class="text-muted-foreground group-hover:text-primary/60 transition-colors"
        >.</span
      >
      <span
        class="text-foreground font-bold group-hover:text-foreground/70 transition-colors"
        >Lucas</span
      >
      <span
        class="text-muted-foreground group-hover:text-foreground/50 transition-colors"
        >/&gt;</span
      >
    </span>
  </a>
  <nav class="">
    <!-- Desktop -->
    <div class="hidden md:flex items-center gap-4">
      {
        navLinks.map((link) => (
          <a
            class="px-4 py-2 text-lg text-primary hover:text-primary/50 hover:bg-surface"
            href={link.href}
          >
            {link.label}
          </a>
        ))
      }
      <div>
        <button id="theme-button" class="absolute">
          <Sun
            class="absolute rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"
          />
          <Moon
            class="absolute rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"
          />
        </button>
        <button> </button>
      </div>
    </div>

    <!-- mobile menu button -->
    <button
      aria-expanded="false"
      class="group block md:hidden p-2 text-primary hover:cursor-pointer"
      id="menu-button"
    >
      <Menu class="group-aria-expanded:hidden" />
      <X class="hidden group-aria-expanded:block" />
    </button>
  </nav>

  <!-- mobile menu -->
  <div
    role="menu"
    aria-hidden="true"
    class="hidden sm:hidden bg-background border-b border-border absolute top-24 left-0 right-0 z-100"
    id="mobile-menu"
  >
    <div class="container mx-auto px-6 py-6 flex flex-col gap-4">
      {
        navLinks.map((link) => (
          <a
            class="text-lg text-muted-foreground hover:text-primary py-2"
            href={link.href}
          >
            {link.label}
          </a>
        ))
      }
      <button
        id="mobile-theme-button"
        class="flex items-center gap-3 py-2 text-lg text-muted-foreground hover:text-primary hover:cursor-pointer"
      >
        <Sun class="h-5 w-5 rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0 dark:absolute" />
        <Moon class="h-5 w-5 rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100 absolute dark:relative" />
        <span class="dark:hidden">Light mode</span>
        <span class="hidden dark:inline">Dark mode</span>
      </button>
    </div>
  </div>
</header>

<script>
  document.addEventListener('astro:page-load', () => {
    // Reset mobile menu state on navigation
    const button = document.getElementById('menu-button');
    const menu = document.getElementById('mobile-menu');
    button?.setAttribute('aria-expanded', 'false');
    menu?.setAttribute('aria-hidden', 'true');
    menu?.classList.add('hidden');
    menu?.classList.remove('animate-fade-in', 'animate-fade-out');

    button?.addEventListener('click', () => {
      const isExpanded = button.getAttribute('aria-expanded') === 'true';
      button.setAttribute('aria-expanded', isExpanded ? 'false' : 'true');
      menu?.setAttribute('aria-hidden', isExpanded ? 'true' : 'false');
      if (isExpanded) {
        menu?.classList.add('animate-fade-out');
        menu?.classList.remove('animate-fade-in');
      } else {
        menu?.classList.remove('animate-fade-out');
        menu?.classList.remove('hidden');
        menu?.classList.add('animate-fade-in');
      }
    });

    // Handle hash scrolling after view transitions
    if (window.location.hash) {
      const el = document.querySelector(window.location.hash);
      el?.scrollIntoView({ behavior: 'smooth' });
    }

    function toggleTheme() {
      if (document.documentElement.classList.contains('dark')) {
        document.documentElement.classList.remove('dark');
        document.documentElement.classList.add('light');
        localStorage.setItem('theme', 'light');
      } else {
        document.documentElement.classList.remove('light');
        document.documentElement.classList.add('dark');
        localStorage.setItem('theme', 'dark');
      }
    }

    document.getElementById('theme-button')?.addEventListener('click', toggleTheme);
    document.getElementById('mobile-theme-button')?.addEventListener('click', toggleTheme);
  });
</script>
